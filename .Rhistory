) +
# Add labs and theme
labs(y = "Year",
x = "Standardised Mean Difference (Positive Values Favour Self-Talk)",
title = "Cummulative Updating of Posterior Pooled Estimate",
subtitle = "Each year uses the previous years posterior pooled estimate as its prior") +
# scale_y_continuous(limits = c(-0.5, 1), breaks = c(-0.5, 0, 0.5, 1)) +
scale_y_discrete(limits = rev,
labels = function(x) str_wrap(x, width = 15)) +
theme_classic() +
theme(panel.border = element_rect(fill = NA),
plot.subtitle = element_text(size=6))
prior_draws <-
prior_main_model %>%
spread_draws(b_Intercept) %>%
mutate(year = "Hatzigeorgiadis et al., 2011",
prior = NA) %>%
select(year, b_Intercept, prior)
cummulative_draws <-
cummulative_draws %>%
filter(year != "Prior (Hatzigeorgiadis et al., 2011)")
prior_draws <-
prior_main_model %>%
spread_draws(b_Intercept) %>%
mutate(year = "Hatzigeorgiadis et al., 2011",
prior = NA) %>%
select(year, b_Intercept, prior)
cummulative_draws <- rbind(prior_draws, cummulative_draws) %>%
mutate(year = factor(year, levels = c(
"Hatzigeorgiadis et al., 2011",
"2011",
"2012",
"2013",
"2014",
"2015",
"2016",
"2017",
"2018",
"2019",
"2020",
"2021",
"2022"
)))
cummulative_draws %>%
ggplot(aes(y = year, x = b_Intercept)) +
# Add ref line at zero
geom_vline(xintercept = 0, linetype = 2) +
# Add densities and point intervals
geom_density_ridges(
fill = "darkgrey",
rel_min_height = 0.01,
scale = 1,
alpha = 0.8
) +
stat_pointinterval(point_interval = mean_qi,
.width = .95,
size = 1) +
# Add individual study data subset(Data_effects, !is.na(yi)), aes(x = yi, y = study_name)
geom_point(
data = subset(data_effect_sizes,!is.na(yi)),
aes(x = yi, y = as.factor(year)),
position = position_nudge(y = -0.1),
shape = "|"
) +
# Add labs and theme
labs(y = "Year",
x = "Standardised Mean Difference (Positive Values Favour Self-Talk)",
title = "Cummulative Updating of Posterior Pooled Estimate",
subtitle = "Each year uses the previous years posterior pooled estimate as its prior") +
# scale_y_continuous(limits = c(-0.5, 1), breaks = c(-0.5, 0, 0.5, 1)) +
scale_y_discrete(limits = rev,
labels = function(x) str_wrap(x, width = 15)) +
theme_classic() +
theme(panel.border = element_rect(fill = NA),
plot.subtitle = element_text(size=6))
renv::install("gganimate")
cummulative_draws %>%
ggplot(aes(y = year, x = b_Intercept)) +
# Add ref line at zero
geom_vline(xintercept = 0, linetype = 2) +
# Add densities and point intervals
geom_density_ridges(
fill = "darkgrey",
rel_min_height = 0.01,
scale = 1,
alpha = 0.8
) +
stat_pointinterval(point_interval = mean_qi,
.width = .95,
size = 1) +
# Add individual study data subset(Data_effects, !is.na(yi)), aes(x = yi, y = study_name)
geom_point(
data = subset(data_effect_sizes,!is.na(yi)),
aes(x = yi, y = as.factor(year)),
position = position_nudge(y = -0.1),
shape = "|"
) +
# Add labs and theme
labs(y = "Year",
x = "Standardised Mean Difference (Positive Values Favour Self-Talk)",
title = "Cummulative Updating of Posterior Pooled Estimate",
subtitle = "Each year uses the previous years posterior pooled estimate as its prior") +
# scale_y_continuous(limits = c(-0.5, 1), breaks = c(-0.5, 0, 0.5, 1)) +
scale_y_discrete(limits = rev,
labels = function(x) str_wrap(x, width = 15)) +
theme_classic() +
theme(panel.border = element_rect(fill = NA),
plot.subtitle = element_text(size=6)) +
transition_states(year,
transition_length = 2,
state_length = 1)
cummulative_draws %>%
ggplot(aes(y = year, x = b_Intercept)) +
# Add ref line at zero
geom_vline(xintercept = 0, linetype = 2) +
# Add densities and point intervals
geom_density_ridges(
fill = "darkgrey",
rel_min_height = 0.01,
scale = 1,
alpha = 0.8
) +
stat_pointinterval(point_interval = mean_qi,
.width = .95,
size = 1) +
# Add individual study data subset(Data_effects, !is.na(yi)), aes(x = yi, y = study_name)
geom_point(
data = subset(data_effect_sizes,!is.na(yi)),
aes(x = yi, y = as.factor(year)),
position = position_nudge(y = -0.1),
shape = "|"
) +
# Add labs and theme
labs(y = "Year",
x = "Standardised Mean Difference (Positive Values Favour Self-Talk)",
title = "Cummulative Updating of Posterior Pooled Estimate",
subtitle = "Each year uses the previous years posterior pooled estimate as its prior") +
# scale_y_continuous(limits = c(-0.5, 1), breaks = c(-0.5, 0, 0.5, 1)) +
scale_y_discrete(limits = rev,
labels = function(x) str_wrap(x, width = 15)) +
theme_classic() +
theme(panel.border = element_rect(fill = NA),
plot.subtitle = element_text(size=6)) +
gganimate::transition_states(year,
transition_length = 2,
state_length = 1)
anim <- cummulative_draws %>%
ggplot(aes(y = year, x = b_Intercept)) +
# Add ref line at zero
geom_vline(xintercept = 0, linetype = 2) +
# Add densities and point intervals
geom_density_ridges(
fill = "darkgrey",
rel_min_height = 0.01,
scale = 1,
alpha = 0.8
) +
stat_pointinterval(point_interval = mean_qi,
.width = .95,
size = 1) +
# Add individual study data subset(Data_effects, !is.na(yi)), aes(x = yi, y = study_name)
geom_point(
data = subset(data_effect_sizes,!is.na(yi)),
aes(x = yi, y = as.factor(year)),
position = position_nudge(y = -0.1),
shape = "|"
) +
# Add labs and theme
labs(y = "Year",
x = "Standardised Mean Difference (Positive Values Favour Self-Talk)",
title = "Cummulative Updating of Posterior Pooled Estimate",
subtitle = "Each year uses the previous years posterior pooled estimate as its prior") +
# scale_y_continuous(limits = c(-0.5, 1), breaks = c(-0.5, 0, 0.5, 1)) +
scale_y_discrete(limits = rev,
labels = function(x) str_wrap(x, width = 15)) +
theme_classic() +
theme(panel.border = element_rect(fill = NA),
plot.subtitle = element_text(size=6)) +
gganimate::transition_states(year,
transition_length = 2,
state_length = 1)
anim
library(gganimate)
renv::install("gifski")
renv::install("av")
cummulative_draws %>%
ggplot(aes(y = year, x = b_Intercept)) +
# Add ref line at zero
geom_vline(xintercept = 0, linetype = 2) +
# Add densities and point intervals
geom_density_ridges(
fill = "darkgrey",
rel_min_height = 0.01,
scale = 1,
alpha = 0.8
) +
stat_pointinterval(point_interval = mean_qi,
.width = .95,
size = 1) +
# Add individual study data subset(Data_effects, !is.na(yi)), aes(x = yi, y = study_name)
geom_point(
data = subset(data_effect_sizes,!is.na(yi)),
aes(x = yi, y = as.factor(year)),
position = position_nudge(y = -0.1),
shape = "|"
) +
# Add labs and theme
labs(y = "Year",
x = "Standardised Mean Difference (Positive Values Favour Self-Talk)",
title = "Cummulative Updating of Posterior Pooled Estimate",
subtitle = "Each year uses the previous years posterior pooled estimate as its prior") +
# scale_y_continuous(limits = c(-0.5, 1), breaks = c(-0.5, 0, 0.5, 1)) +
scale_y_discrete(limits = rev,
labels = function(x) str_wrap(x, width = 15)) +
theme_classic() +
theme(panel.border = element_rect(fill = NA),
plot.subtitle = element_text(size=6)) +
transition_states(year,
transition_length = 2,
state_length = 1)
anim <- cummulative_draws %>%
ggplot(aes(y = year, x = b_Intercept)) +
# Add ref line at zero
geom_vline(xintercept = 0, linetype = 2) +
# Add densities and point intervals
geom_density_ridges(
fill = "darkgrey",
rel_min_height = 0.01,
scale = 1,
alpha = 0.8
) +
stat_pointinterval(point_interval = mean_qi,
.width = .95,
size = 1) +
# Add individual study data subset(Data_effects, !is.na(yi)), aes(x = yi, y = study_name)
geom_point(
data = subset(data_effect_sizes,!is.na(yi)),
aes(x = yi, y = as.factor(year)),
position = position_nudge(y = -0.1),
shape = "|"
) +
# Add labs and theme
labs(y = "Year",
x = "Standardised Mean Difference (Positive Values Favour Self-Talk)",
title = "Cummulative Updating of Posterior Pooled Estimate",
subtitle = "Each year uses the previous years posterior pooled estimate as its prior\nPosterior distributions, mean and 95% quantile intervals, and individual effects (ticks)") +
# scale_y_continuous(limits = c(-0.5, 1), breaks = c(-0.5, 0, 0.5, 1)) +
scale_y_discrete(limits = rev,
labels = function(x) str_wrap(x, width = 15)) +
theme_classic() +
theme(panel.border = element_rect(fill = NA),
plot.subtitle = element_text(size=6)) +
transition_states(year,
transition_length = 2,
state_length = 1)
targets::tar_visnetwork()
targets::tar_make_future(workers = 4)
targets::tar_make_future(workers = 4)
data <- data_effect_sizes %>%
mutate(year = as.numeric(as.character(year)))
View(data)
targets::tar_make_future(workers = 4)
targets::tar_make_future(workers = 4)
targets::tar_visnetwork()
unique(data$year)
list(unique(data$year))
targets::tar_make()
targets::tar_make()
targets::tar_make()
View(prior_draws)
targets::tar_load(cummulative_draws)
target
targets::tar_load(cumulative_draws)
targets::tar_visnetwork()
targets::tar_make()
targets::tar_load(cumulative_draws)
View(cumulative_draws)
View(prior_draws)
rbind(prior_draws, cumulative_draws)
prior_draws <-
prior_model %>%
spread_draws(b_Intercept) %>%
mutate(year = "Hatzigeorgiadis et al., (2011)") %>%
select(year, b_Intercept)
prior_draws <-
prior_main_model %>%
spread_draws(b_Intercept) %>%
mutate(year = "Hatzigeorgiadis et al., (2011)") %>%
select(year, b_Intercept)
rbind(prior_draws, cumulative_draws)
cumulative_draws <- rbind(prior_draws, cumulative_draws) %>%
mutate(year = factor(year, levels = c(
"Hatzigeorgiadis et al., (2011)",
"2011",
"2012",
"2013",
"2014",
"2015",
"2016",
"2017",
"2018",
"2019",
"2020",
"2021",
"2022"
)))
cumulative_draws %>%
ggplot(aes(y = year, x = b_Intercept)) +
# Add ref line at zero
geom_vline(xintercept = 0, linetype = 2) +
# Add densities and point intervals
geom_density_ridges(
fill = "darkgrey",
rel_min_height = 0.01,
scale = 1,
alpha = 0.8
) +
stat_pointinterval(point_interval = mean_qi,
.width = .95,
size = 1) +
# Add individual study data subset(Data_effects, !is.na(yi)), aes(x = yi, y = study_name)
geom_point(
data = subset(data,!is.na(yi)),
aes(x = yi, y = as.factor(year)),
position = position_nudge(y = -0.1),
shape = "|"
) +
# Add labs and theme
labs(y = "Year",
x = "Standardised Mean Difference (Positive Values Favour Self-Talk)",
title = "Cumulative Updating of Posterior Pooled Estimate",
subtitle = "Each year uses the previous years posterior pooled estimate as its prior\nPosterior distributions, mean and 95% quantile intervals, and individual effects (ticks)") +
# scale_y_continuous(limits = c(-0.5, 1), breaks = c(-0.5, 0, 0.5, 1)) +
scale_y_discrete(limits = rev,
labels = function(x) str_wrap(x, width = 15)) +
theme_classic() +
theme(panel.border = element_rect(fill = NA),
plot.subtitle = element_text(size=6))
targets::tar_make()
targets::tar_make()
View(prior_draws)
prior_draws <-
prior_main_model %>%
spread_draws(b_Intercept) %>%
mutate(year = "Hatzigeorgiadis et al., (2011)")
View(prior_draws)
targets::tar_make()
targets::tar_load(cumulative_draws)
View(cumulative_draws)
targets::tar_load(prior_main_model)
prior_main_model %>%
spread_draws(b_Intercept) %>%
mutate(year = "Hatzigeorgiadis et al., (2011)") %>%
select(year, b_Intercept)
prior_draws <- prior_main_model %>%
spread_draws(b_Intercept) %>%
mutate(year = "Hatzigeorgiadis et al., (2011)") %>%
select(year, b_Intercept)
cumulative_draws <- rbind(prior_draws, cumulative_draws) %>%
mutate(year = factor(year, levels = c(
"Hatzigeorgiadis et al., (2011)",
"2011",
"2012",
"2013",
"2014",
"2015",
"2016",
"2017",
"2018",
"2019",
"2020",
"2021",
"2022"
)))
cumulative_draws %>%
ggplot(aes(y = year, x = b_Intercept)) +
# Add ref line at zero
geom_vline(xintercept = 0, linetype = 2) +
# Add densities and point intervals
geom_density_ridges(
fill = "darkgrey",
rel_min_height = 0.01,
scale = 1,
alpha = 0.8
) +
stat_pointinterval(point_interval = mean_qi,
.width = .95,
size = 1) +
# Add individual study data subset(Data_effects, !is.na(yi)), aes(x = yi, y = study_name)
geom_point(
data = subset(data,!is.na(yi)),
aes(x = yi, y = as.factor(year)),
position = position_nudge(y = -0.1),
shape = "|"
) +
# Add labs and theme
labs(y = "Year",
x = "Standardised Mean Difference (Positive Values Favour Self-Talk)",
title = "Cumulative Updating of Posterior Pooled Estimate",
subtitle = "Each year uses the previous years posterior pooled estimate as its prior\nPosterior distributions, mean and 95% quantile intervals, and individual effects (ticks)") +
# scale_y_continuous(limits = c(-0.5, 1), breaks = c(-0.5, 0, 0.5, 1)) +
scale_y_discrete(limits = rev,
labels = function(x) str_wrap(x, width = 15)) +
theme_classic() +
theme(panel.border = element_rect(fill = NA),
plot.subtitle = element_text(size=6))
targets::tar_make()
?select
targets::tar_make()
targets::tar_make()
targets::tar_make()
posterior_summary <- group_by(cumulative_draws, year) %>%
mean_qi(b_Intercept)
cumulative_draws %>%
ggplot(aes(y = year, x = b_Intercept)) +
# Add ref line at zero
geom_vline(xintercept = 0, linetype = 2) +
# Add densities and point intervals
geom_density_ridges(
fill = "darkgrey",
rel_min_height = 0.01,
scale = 1,
alpha = 0.8
) +
stat_pointinterval(point_interval = mean_qi,
.width = .95,
size = 1) +
# Add individual study data subset(Data_effects, !is.na(yi)), aes(x = yi, y = study_name)
geom_point(
data = subset(data,!is.na(yi)),
aes(x = yi, y = as.factor(year)),
position = position_nudge(y = -0.1),
shape = "|"
) +
# Add text and labels
geom_text(
data = mutate_if(posterior_summary,
is.numeric, round, 2),
aes(
label = glue::glue("{b_Intercept} [{.lower}, {.upper}]"),
x = 4
),
hjust = "inward",
size = 3
) +
# Add labs and theme
labs(y = "Year",
x = "Standardised Mean Difference (Positive Values Favour Self-Talk)",
title = "Cumulative Updating of Posterior Pooled Estimate",
subtitle = "Each year uses the previous years posterior pooled estimate as its prior\nPosterior distributions, mean and 95% quantile intervals, and individual effects (ticks)") +
# scale_y_continuous(limits = c(-0.5, 1), breaks = c(-0.5, 0, 0.5, 1)) +
scale_y_discrete(limits = rev,
labels = function(x) str_wrap(x, width = 15)) +
theme_classic() +
theme(panel.border = element_rect(fill = NA),
plot.subtitle = element_text(size=6))
cumulative_draws %>%
ggplot(aes(y = year, x = b_Intercept)) +
# Add ref line at zero
geom_vline(xintercept = 0, linetype = 2) +
# Add densities and point intervals
geom_density_ridges(
fill = "darkgrey",
rel_min_height = 0.01,
scale = 1,
alpha = 0.8
) +
stat_pointinterval(point_interval = mean_qi,
.width = .95,
size = 1) +
# Add individual study data subset(Data_effects, !is.na(yi)), aes(x = yi, y = study_name)
# geom_point(
#   data = subset(data,!is.na(yi)),
#   aes(x = yi, y = as.factor(year)),
#   position = position_nudge(y = -0.1),
#   shape = "|"
# ) +
# Add text and labels
geom_text(
data = mutate_if(posterior_summary,
is.numeric, round, 2),
aes(
label = glue::glue("{b_Intercept} [{.lower}, {.upper}]"),
x = 4
),
hjust = "inward",
size = 3
) +
# Add labs and theme
labs(y = "Year",
x = "Standardised Mean Difference (Positive Values Favour Self-Talk)",
title = "Cumulative Updating of Posterior Pooled Estimate",
subtitle = "Each year uses the previous years posterior pooled estimate as its prior\nPosterior distributions, mean and 95% quantile intervals, and individual effects (ticks)") +
# scale_y_continuous(limits = c(-0.5, 1), breaks = c(-0.5, 0, 0.5, 1)) +
scale_y_discrete(limits = rev,
labels = function(x) str_wrap(x, width = 15)) +
theme_classic() +
theme(panel.border = element_rect(fill = NA),
plot.subtitle = element_text(size=6))
targets::tar_make()
targets::tar_load(cumulative_main_model_plot)
cumulative_main_model_plot +
transition_states(year,
transition_length = 2,
state_length = 1)
targets::tar_visnetwork()
targets::tar_visnetwork()
targets::tar_make()
targets::tar_load(cumulative_draws)
View(cumulative_draws)
unique(cumulative_draws$prior)
targets::tar_load(cumulative_main_model_plot)
